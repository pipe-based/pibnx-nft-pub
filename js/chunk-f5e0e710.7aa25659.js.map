{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./src/views/nft/pibnx/index.vue","webpack:///./src/views/nft/pibnx/index.vue?08c4"],"names":["uncurryThis","PROPER_FUNCTION_NAME","PROPER","redefine","anObject","isPrototypeOf","$toString","fails","regExpFlags","TO_STRING","RegExpPrototype","RegExp","prototype","n$ToString","getFlags","NOT_GENERIC","call","source","flags","INCORRECT_NAME","name","R","this","p","rf","f","undefined","unsafe","style","nftPibnxBalanceEffect","nftPibnxBalance","heroBalance","AmountNeedBuyPiBNX","ref","amount","placeholder","min","max","step","type","mint","loading","isMinting","nftPibnxPrice","data","nftPibnxTokens","stripe","label","width","default","scope","$index","src","tokenURIImage","row","tokenURI","tokenId","birthBlock","remainTimeLens","remainBlock","__exports__","render","nftImage","nftSvg","computed","heros","Math","ceil","watch","val","mounted","methods","j","JSON","parse","Buffer","from","substring","toString","image","getSvg","b64","console","log","jsonC","jsonO","days","floor","hours","toFixed","warning","$refs","focus","$store","dispatch","then","success","catch","err","error"],"mappings":"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","file":"js/chunk-f5e0e710.7aa25659.js","sourcesContent":["'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar $toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar regExpFlags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar n$ToString = RegExpPrototype[TO_STRING];\nvar getFlags = uncurryThis(regExpFlags);\n\nvar NOT_GENERIC = fails(function () { return n$ToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = PROPER_FUNCTION_NAME && n$ToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = $toString(R.source);\n    var rf = R.flags;\n    var f = $toString(rf === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype) ? getFlags(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","<template>\n  <div style=\"text-align:left;\">\n    <div>\n      您拥有\n      <font style=\"color:blue;\">{{ nftPibnxBalanceEffect }}</font> 个有效PiBNX\n      ，{{ nftPibnxBalance - nftPibnxBalanceEffect }} 个已过期PiBNX。<br />\n      可批量管理\n      <font style=\"color:blue;\">{{ nftPibnxBalanceEffect * 100 }}</font>\n      个英雄,已有<font style=\"color:blue;\">{{ heroBalance }}</font\n      >个英雄。<br />需要购买\n      <font style=\"color:blue;\">{{ AmountNeedBuyPiBNX }}</font> 个PiBNX\n    </div>\n    <el-input-number\n      ref=\"nft-amount\"\n      v-model=\"amount\"\n      placeholder=\"1-20\"\n      :min=\"1\"\n      :max=\"20\"\n      :step=\"5\"\n      style=\"width:180px;\"\n    ></el-input-number>\n    <el-button type=\"primary\" @click.prevent=\"mint\" :loading=\"isMinting\"\n      >购买</el-button\n    >\n    <p style=\"color:grey;\">\n      <label>每个PiBNX售价为 </label\n      ><font style=\"color:blue\"> {{ nftPibnxPrice }}</font> BNB,每次可购买<font\n        style=\"color:blue\"\n        >1</font\n      >-<font style=\"color:blue\">20</font>个\n    </p>\n    <div>\n      <el-table :data=\"nftPibnxTokens\" stripe>\n        <el-table-column label=\"序号\" width=\"50\">\n          <template #default=\"scope\">\n            {{ scope.$index + 1 }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"NFT\" width=\"300\">\n          <template #default=\"scope\">\n            <img :src=\"tokenURIImage(scope.row.tokenURI)\" />\n          </template>\n        </el-table-column>\n        <el-table-column label=\"tokenId\" width=\"100\">\n          <template #default=\"scope\">\n            {{ scope.row.tokenId }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"购买区块高度\" width=\"100\">\n          <template #default=\"scope\">\n            {{ scope.row.birthBlock }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"剩余时长\" width=\"150\">\n          <template #default=\"scope\">\n            {{ remainTimeLens(scope.row.remainBlock) }}\n          </template>\n        </el-table-column>\n      </el-table>\n      <div v-if=\"false\">\n        <img style=\"width:200px;height:200px;\" :src=\"nftImage\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ElMessage } from \"element-plus\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  data: function() {\n    return {\n      amount: 5,\n      isMinting: false,\n      nftImage: \"\",\n      nftSvg:\n        \"data:application/json;base64,eyJuYW1lIjogIlBpQk5YICMxIiwgImRlc2NyaXB0aW9uIjogIlBpQk5YIGlzIGEgdG9rZW4uIGlmIHlvdSBoYXZlIFBpQk5YICx5b3UgY2FuIHVzZSB0b29scyB0aGF0IGNhbiBoZWxwIHlvdSBwbGF5IGJpbmFyeXggZ2FtZS5BcyBhIHJlc3VsdCx5b3UgY2FuIHBsYXkgdG8gZWFybiBtb3JlIG1vbmV5IG1vcmUgcXVpY2tseSEgIiwgImltYWdlIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIQnlaWE5sY25abFFYTndaV04wVW1GMGFXODlJbmhOYVc1WlRXbHVJRzFsWlhRaUlIWnBaWGRDYjNnOUlqQWdNQ0F6TURBZ01UVXdJajQ4YzNSNWJHVStMbUpoYzJVZ2V5Qm1hV3hzT2lCM2FHbDBaVHNnWm05dWRDMW1ZVzFwYkhrNklITmxjbWxtT3lCbWIyNTBMWE5wZW1VNklESTRjSGc3SUgwOEwzTjBlV3hsUGp4eVpXTjBJSGRwWkhSb1BTSXhNREFsSWlCb1pXbG5hSFE5SWpFd01DVWlJR1pwYkd3OUltSnNZV05ySWlBdlBqeDBaWGgwSUhnOUlqRXdJaUI1UFNJME1DSWdZMnhoYzNNOUltSmhjMlVpUGlCQ2FXNWhjbmxZSUNNZ01Ud3ZkR1Y0ZEQ0OGRHVjRkQ0I0UFNJeE1DSWdlVDBpT0RBaUlHTnNZWE56UFNKaVlYTmxJajVOWVhoSVpYSnZjem9nTVRBd1BDOTBaWGgwUGp4MFpYaDBJSGc5SWpFd0lpQjVQU0l4TWpBaUlHTnNZWE56UFNKaVlYTmxJajVJVURvZ05ETXlNREF3SUdKc2IyTnJjend2ZEdWNGRENDhMM04yWno0PSJ9\",\n    };\n  },\n  computed: {\n    ...mapGetters([\n      \"nftPibnxBalance\",\n      \"nftPibnxBalanceEffect\",\n      \"nftPibnxTokens\",\n      \"nftPibnxPrice\",\n      \"heroBalance\",\n    ]),\n    AmountNeedBuyPiBNX: function() {\n      const heros = this.heroBalance - this.nftPibnxBalanceEffect * 100;\n      if (heros < 1) {\n        return 0;\n      }\n      if (heros < 100) {\n        return 1;\n      }\n      return Math.ceil(heros / 100);\n    },\n  },\n  watch: {\n    AmountNeedBuyPiBNX: function(val) {\n      if (val >= 1 && val <= 20) {\n        this.amount = val;\n      }\n    },\n  },\n  mounted: function() {\n    // this.getSvg();\n  },\n  methods: {\n    tokenURIImage: function(tokenURI) {\n      const j = JSON.parse(\n        Buffer.from(tokenURI.substring(29), \"base64\").toString()\n      );\n      return j.image;\n    },\n    getSvg: function() {\n      const b64 = this.nftSvg.substring(29);\n      console.log(\"b64=\", b64);\n      const jsonC = Buffer.from(b64, \"base64\").toString();\n      console.log(jsonC);\n      const jsonO = JSON.parse(jsonC);\n      console.log(jsonO);\n      console.log(jsonO.image);\n      this.nftImage = jsonO.image;\n    },\n    remainTimeLens: function(remainBlock) {\n      if (remainBlock <= 0) {\n        return `已过期`;\n      }\n      if (remainBlock > 20 * 60 * 24) {\n        const days = Math.floor(remainBlock / (20 * 60 * 24));\n        const hours = ((remainBlock % (20 * 60 * 24)) / (20 * 60)).toFixed(2);\n        return ` ${days}天 ${hours}小时 `;\n      } else {\n        const hours = (remainBlock / (20 * 60)).toFixed(2);\n        return ` ${hours}小时 `;\n      }\n    },\n    mint: async function() {\n      console.log(\"mint amount=\", this.amount);\n      if (this.amount == undefined || this.amount == 0 || this.amount > 20) {\n        ElMessage.warning(\"购买数量不对[1-20]\");\n        this.$refs[\"nft-amount\"].focus();\n        return;\n      }\n      this.isMinting = true;\n      await this.$store\n        .dispatch(\"pibnx/mint\", { amount: this.amount })\n        .then(() => {\n          this.isMinting = false;\n          ElMessage.success(\"success\");\n          this.$store.dispatch(\"pibnx/balanceOf\");\n        })\n        .catch((err) => {\n          console.log(err);\n          if (err == \"余额不足\") {\n            ElMessage.warning(err);\n          } else {\n            ElMessage.error(\"fail\");\n          }\n          this.isMinting = false;\n        });\n      this.isMinting = false;\n    },\n  },\n};\n</script>\n\n<style></style>\n","import { render } from \"./index.vue?vue&type=template&id=1efd1fa9\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/pipe/pipe/pi4/groups/aesfeel/dajin/pibnx/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}